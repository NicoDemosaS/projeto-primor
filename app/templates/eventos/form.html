{% extends "base.html" %}

{% block title %}{{ 'Editar' if evento else 'Novo' }} Evento - Primor Garçons{% endblock %}

{% block content %}
<div class="p-8">
    <!-- Header -->
    <div class="flex items-center gap-4 mb-8">
        <a href="{{ url_for('eventos.index') }}" class="text-gray-400 hover:text-white transition-colors">
            ← Voltar
        </a>
        <h1 class="text-2xl font-semibold text-white">{{ 'Editar Evento' if evento else 'Novo Evento' }}</h1>
    </div>
    
    <!-- Form -->
    <div class="max-w-2xl">
        <form method="POST" class="bg-gray-800/50 backdrop-blur-sm border border-white/10 rounded-xl p-6 space-y-6">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            
            <!-- Nome -->
            <div>
                <label for="nome" class="block text-sm font-medium text-gray-300 mb-2">Nome do Evento *</label>
                <input type="text" id="nome" name="nome" required
                       value="{{ evento.nome if evento else '' }}"
                       placeholder="Ex: Casamento Silva & Costa"
                       class="w-full rounded-md bg-white/5 px-3 py-2 text-white outline-1 -outline-offset-1 outline-white/10 placeholder:text-gray-500 focus:outline-2 focus:-outline-offset-2 focus:outline-amber-400">
            </div>
            
            <!-- Tipo -->
            <div>
                <label for="tipo" class="block text-sm font-medium text-gray-300 mb-2">Tipo de Evento *</label>
                <input type="text" id="tipo" name="tipo" required
                       value="{{ evento.tipo if evento else '' }}"
                       placeholder="Ex: Casamento, Aniversário, Corporativo..."
                       class="w-full rounded-md bg-white/5 px-3 py-2 text-white outline-1 -outline-offset-1 outline-white/10 placeholder:text-gray-500 focus:outline-2 focus:-outline-offset-2 focus:outline-amber-400">
            </div>
            
            <!-- Data e Hora -->
            <div class="grid grid-cols-3 gap-4">
                <div>
                    <label for="data" class="block text-sm font-medium text-gray-300 mb-2">Data *</label>
                    <input type="text" id="data" name="data" required
                           value="{{ evento.data.strftime('%d/%m/%Y') if evento else '' }}"
                           placeholder="dd/mm/aaaa"
                           maxlength="10"
                           class="w-full rounded-md bg-white/5 px-3 py-2 text-white outline-1 -outline-offset-1 outline-white/10 placeholder:text-gray-500 focus:outline-2 focus:-outline-offset-2 focus:outline-amber-400">
                </div>
                <div>
                    <label for="hora_inicio" class="block text-sm font-medium text-gray-300 mb-2">Hora Início *</label>
                    <input type="text" id="hora_inicio" name="hora_inicio" required
                           value="{{ evento.hora_inicio.strftime('%H:%M') if evento and evento.hora_inicio else '' }}"
                           placeholder="00:00"
                           maxlength="5"
                           class="w-full rounded-md bg-white/5 px-3 py-2 text-white outline-1 -outline-offset-1 outline-white/10 placeholder:text-gray-500 focus:outline-2 focus:-outline-offset-2 focus:outline-amber-400">
                </div>
                <div>
                    <label for="hora_fim" class="block text-sm font-medium text-gray-300 mb-2">Hora Fim</label>
                    <input type="text" id="hora_fim" name="hora_fim"
                           value="{{ evento.hora_fim.strftime('%H:%M') if evento and evento.hora_fim else '' }}"
                           placeholder="00:00"
                           maxlength="5"
                           class="w-full rounded-md bg-white/5 px-3 py-2 text-white outline-1 -outline-offset-1 outline-white/10 placeholder:text-gray-500 focus:outline-2 focus:-outline-offset-2 focus:outline-amber-400">
                </div>
            </div>
            
            <!-- Local -->
            <div>
                <label for="local" class="block text-sm font-medium text-gray-300 mb-2">Local *</label>
                <input type="text" id="local" name="local" required
                       value="{{ evento.local if evento else '' }}"
                       placeholder="Ex: Espaço Villa Verde - Av. Principal, 1000"
                       class="w-full rounded-md bg-white/5 px-3 py-2 text-white outline-1 -outline-offset-1 outline-white/10 placeholder:text-gray-500 focus:outline-2 focus:-outline-offset-2 focus:outline-amber-400">
            </div>
            
            <!-- Descrição -->
            <div>
                <label for="descricao" class="block text-sm font-medium text-gray-300 mb-2">Descrição</label>
                <textarea id="descricao" name="descricao" rows="3"
                          placeholder="Informações adicionais sobre o evento, traje, etc..."
                          class="w-full rounded-md bg-white/5 px-3 py-2 text-white outline-1 -outline-offset-1 outline-white/10 placeholder:text-gray-500 focus:outline-2 focus:-outline-offset-2 focus:outline-amber-400">{{ evento.descricao if evento else '' }}</textarea>
            </div>
            
            <!-- Valores -->
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label for="valor_padrao" class="block text-sm font-medium text-gray-300 mb-2">Valor por Garçom (R$) *</label>
                    <input type="number" id="valor_padrao" name="valor_padrao" required step="0.01" min="0"
                           value="{{ '%.2f'|format(evento.valor_padrao|float) if evento and evento.valor_padrao else '0.00' }}"
                           placeholder="150.00"
                           class="w-full rounded-md bg-white/5 px-3 py-2 text-white outline-1 -outline-offset-1 outline-white/10 placeholder:text-gray-500 focus:outline-2 focus:-outline-offset-2 focus:outline-amber-400">
                    <p class="text-xs text-gray-500 mt-1">Valor padrão para cada garçom</p>
                </div>
                <div>
                    <label for="valor_motorista" class="block text-sm font-medium text-gray-300 mb-2">Adicional Motorista (R$)</label>
                    <input type="number" id="valor_motorista" name="valor_motorista" step="0.01" min="0"
                           value="{{ '%.2f'|format(evento.valor_motorista|float) if evento and evento.valor_motorista else '0.00' }}"
                           placeholder="50.00"
                           class="w-full rounded-md bg-white/5 px-3 py-2 text-white outline-1 -outline-offset-1 outline-white/10 placeholder:text-gray-500 focus:outline-2 focus:-outline-offset-2 focus:outline-amber-400">
                    <p class="text-xs text-gray-500 mt-1">Valor extra para quem for de carro</p>
                </div>
            </div>
            
            <!-- Garçons Selection -->
            {% if evento %}
            <div>
                <label class="block text-sm font-medium text-gray-300 mb-2">Garçons do Evento</label>
                <p class="text-sm text-gray-500 mb-3">Gerencie os garçons na página de detalhes do evento.</p>
            </div>
            {% endif %}
            
            <!-- Buttons -->
            <div class="flex items-center gap-4 pt-4">
                <button type="submit" 
                        class="rounded-md bg-amber-400 px-6 py-2 text-sm font-semibold text-gray-900 hover:bg-amber-300 transition-colors">
                    {{ 'Salvar Alterações' if evento else 'Criar Evento' }}
                </button>
                <a href="{{ url_for('eventos.index') }}" 
                   class="rounded-md bg-white/10 px-6 py-2 text-sm font-semibold text-white hover:bg-white/20 transition-colors">
                    Cancelar
                </a>
            </div>
        </form>
    </div>
</div>

<script>
// Máscara para data (dd/mm/aaaa)
document.getElementById('data').addEventListener('input', function(e) {
    let value = e.target.value.replace(/\D/g, '');
    if (value.length >= 2) {
        value = value.substring(0, 2) + '/' + value.substring(2);
    }
    if (value.length >= 5) {
        value = value.substring(0, 5) + '/' + value.substring(5, 9);
    }
    e.target.value = value;
});

// Máscara para hora (00:00)
function maskTime(input) {
    input.addEventListener('input', function(e) {
        let value = e.target.value.replace(/\D/g, '');
        if (value.length >= 2) {
            value = value.substring(0, 2) + ':' + value.substring(2, 4);
        }
        e.target.value = value;
    });
}

maskTime(document.getElementById('hora_inicio'));
maskTime(document.getElementById('hora_fim'));
</script>
{% endblock %}
